[build]
publish = "public"
command = "yarn project-setup; yarn build"
functions = "netlify/functions"

[build.environment]
HUGO_VERSION = "0.147.3"
GO_VERSION = "1.24.2"

# Required Auth0 environment variables for CMS authentication
# These MUST be set in Netlify UI: Site settings â†’ Environment variables
#
# CRITICAL CONFIGURATION:
# - DO NOT mark AUTH0_CLIENT_ID or AUTH0_REDIRECT_URI as "secret"
# - Set scope to "Builds, Deployments, and Functions" (NOT "Runtime-only")
# - These variables must be available during Hugo build (getenv only works at build time)
# - If misconfigured, you'll see "Unknown host: dev-xxxxx.auth0.com" errors
#
# Required variables:
# AUTH0_DOMAIN = "dev-xxxxx.auth0.com"
# AUTH0_CLIENT_ID = "your-auth0-client-id" (public value, safe for frontend)
# AUTH0_REDIRECT_URI = "https://tulau.space/admin/"

# Netlify Identity disabled - using Auth0 for authentication
# [identity]
#   external_providers = ["github", "google"]

[context.production]
  [context.production.environment]
    HUGO_ENV = "production"

[[headers]]
for = "/*"
[headers.values]
Access-Control-Allow-Origin = "*"
Access-Control-Allow-Methods = "GET, POST, PUT, DELETE, OPTIONS"
Access-Control-Allow-Headers = "Origin, X-Requested-With, Content-Type, Accept, Authorization"

[[headers]]
for = "/js/*"
[headers.values]
Access-Control-Allow-Origin = "*"
Cache-Control = "public, max-age=31536000"

[[headers]]
for = "/css/*"
[headers.values]
Access-Control-Allow-Origin = "*"
Cache-Control = "public, max-age=31536000"
